<?xml version="1.0" encoding="UTF-8"?>

<beans
	xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:jaxws="http://cxf.apache.org/jaxws"
    xmlns:osgi="http://www.springframework.org/schema/osgi"
	xsi:schemaLocation="
		http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/osgi http://www.springframework.org/schema/osgi/spring-osgi.xsd
		http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd
	"
>
	<import resource="classpath:META-INF/cxf/cxf.xml" />
	<import resource="classpath:META-INF/cxf/osgi/cxf-extension-osgi.xml" />

    <!-- (1) SL
    <import resource="classpath:META-INF/tesb/locator/beans-osgi.xml" />
     -->
    <!-- SAM -->
    <import resource="classpath:META-INF/tesb/agent-osgi.xml" />

	<jaxws:endpoint
		xmlns:serviceNamespace="http://customerservice.example.com/"
		serviceName="serviceNamespace:CustomerServiceService"
		endpointName="serviceNamespace:CustomerServicePort"
		address="http://localhost:9090/CustomerServicePort"
		wsdlLocation="classpath:/model/CustomerService.wsdl"
		implementor="#genericServiceProvider"
	>
	    <jaxws:features>
		    <!-- (1) SL
			<bean class="org.talend.esb.servicelocator.cxf.LocatorFeature"/>
		     -->
		    <!-- (2) SAM
			<ref bean="eventFeature"/>
		     -->
	    </jaxws:features>
    </jaxws:endpoint>

    <!-- CustomInfoHandler must as a bean because setHandlers() in EventCollectorImpl
         marked as Autowired. Otherwise, it will not work after testing. (c) Xilai Dai -->
    <bean id="customInfoHandler" class="org.talend.esb.sam.common.handler.impl.CustomInfoHandler"/>

	<bean id="genericServiceProvider" class="org.talend.esb.job.controller.GenericServiceProvider">
		<property name="operations">
			<map>
				<entry>
					<key><value>getCustomersByName</value></key>
					<value>ProviderJob</value>
				</entry>
				<entry>
					<key><value>updateCustomer</value></key>
					<value>ESBProvider2</value>
				</entry>
			</map>
		</property>
        <property name="jobLauncher">
		    <osgi:reference interface="org.talend.esb.job.controller.JobLauncher"/>
        </property>
        <property name="customInfoHandler" ref="customInfoHandler"/>
	</bean>

</beans>
